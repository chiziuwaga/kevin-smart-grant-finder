# Render Production Environment Variables

## Required Environment Variables for Render Dashboard

Set these in your Render dashboard for the **grant-finder-api** web service:

### üîê Auth0 (Authentication)
```bash
AUTH0_DOMAIN=your-tenant.us.auth0.com
AUTH0_API_AUDIENCE=https://api.grantfinder.com
AUTH0_ALGORITHMS=RS256  # Already set in render.yaml
```

**How to get:**
1. Go to https://auth0.com ‚Üí Create tenant
2. Create "Single Page Application"
3. Create "API" with identifier `https://api.grantfinder.com`
4. Copy domain from tenant settings

### üí≥ Stripe (Payments)
```bash
STRIPE_SECRET_KEY=sk_live_...  # OR sk_test_... for testing
STRIPE_PUBLISHABLE_KEY=pk_live_...  # OR pk_test_... for testing
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PRICE_ID=price_...  # Your $35/month price ID
```

**How to get:**
1. Go to https://dashboard.stripe.com
2. Create Product ‚Üí Set price to $35/month ‚Üí Copy Price ID
3. Get API keys from Developers ‚Üí API keys
4. Create Webhook endpoint: `https://kevin-smart-grant-finder.onrender.com/api/webhooks/stripe`
5. Select events: `customer.subscription.*`
6. Copy webhook signing secret

### üìß Resend (Email)
```bash
RESEND_API_KEY=re_...
FROM_EMAIL=noreply@yourdomain.com  # Already set in render.yaml
```

**How to get:**
1. Go to https://resend.com ‚Üí Sign up
2. Create API key in dashboard
3. Verify domain (or use resend.dev for testing)

### ü§ñ AI Services

**DeepSeek (Primary AI)**
```bash
DEEPSEEK_API_KEY=sk-...
DEEPSEEK_API_BASE=https://api.deepseek.com  # Already set in render.yaml
```
Get from: https://platform.deepseek.com

**AgentQL (Web Scraping)**
```bash
AGENTQL_API_KEY=agentql_...
```
Get from: https://www.agentql.com

**Pinecone (Vector Database)**
```bash
PINECONE_API_KEY=pcsk_your_pinecone_key_here
PINECONE_INDEX_NAME=grantcluster  # Already set in render.yaml
```
**Note:** Use your existing Pinecone key from your local .env file

**OpenAI (Optional Fallback)**
```bash
OPENAI_API_KEY=sk-proj-your_openai_key_here
```
**Note:** Use your existing OpenAI key from your local .env file

### üåê CORS & Frontend
```bash
FRONTEND_URL=https://your-vercel-app.vercel.app  # Update with actual frontend URL
ALLOWED_ORIGINS=https://your-vercel-app.vercel.app,http://localhost:3000
```

### ‚öôÔ∏è Application Settings
These are **already configured** in render.yaml:
- ‚úÖ `ENVIRONMENT=production`
- ‚úÖ `APP_DEBUG=false`
- ‚úÖ `SECRET_KEY` (auto-generated by Render)
- ‚úÖ `DATABASE_URL` (auto-populated from PostgreSQL)
- ‚úÖ `REDIS_URL` (auto-populated from Redis)
- ‚úÖ `CELERY_BROKER_URL` (auto-populated from Redis)
- ‚úÖ `CELERY_RESULT_BACKEND` (auto-populated from Redis)

---

## Summary: What You MUST Set Manually

| Service | Required | Priority |
|---------|----------|----------|
| **Auth0** | AUTH0_DOMAIN, AUTH0_API_AUDIENCE | üî¥ Critical |
| **Stripe** | All 4 keys (SECRET, PUBLISHABLE, WEBHOOK_SECRET, PRICE_ID) | üî¥ Critical |
| **Resend** | RESEND_API_KEY | üî¥ Critical |
| **DeepSeek** | DEEPSEEK_API_KEY | üî¥ Critical |
| **AgentQL** | AGENTQL_API_KEY | üî¥ Critical |
| **Pinecone** | Already configured ‚úÖ | ‚úÖ Done |
| **OpenAI** | Already configured ‚úÖ | ‚úÖ Done |
| **Frontend URL** | Update FRONTEND_URL, ALLOWED_ORIGINS | üü° Before frontend deploy |

---

## Step-by-Step Setup

1. **In Render Dashboard:**
   - Go to: https://dashboard.render.com
   - Select your **grant-finder-api** service
   - Click **Environment** tab
   - Add each variable above

2. **Test with Placeholder Values (Optional):**
   - Use Stripe test keys (`sk_test_`, `pk_test_`)
   - Use Auth0 dev tenant
   - Test locally first before production

3. **After Setting All Variables:**
   - Click **Manual Deploy** ‚Üí **Deploy latest commit**
   - Monitor logs for any missing variables
   - Check `/health` endpoint: https://kevin-smart-grant-finder.onrender.com/health

---

## Frontend Environment Variables (Vercel)

When deploying frontend to Vercel, set these:

```bash
REACT_APP_API_URL=https://kevin-smart-grant-finder.onrender.com
REACT_APP_AUTH0_DOMAIN=your-tenant.us.auth0.com
REACT_APP_AUTH0_CLIENT_ID=... (from Auth0 app)
REACT_APP_STRIPE_PUBLISHABLE_KEY=pk_live_... (or pk_test_...)
```

---

## Verification Checklist

After setting all variables:

- [ ] Health check passes: `https://kevin-smart-grant-finder.onrender.com/health`
- [ ] API docs load: `https://kevin-smart-grant-finder.onrender.com/docs`
- [ ] Database connection works (check logs)
- [ ] Redis connection works (check logs)
- [ ] Celery worker is running (check worker service logs)
- [ ] No "missing environment variable" errors in logs
